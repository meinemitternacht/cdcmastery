{% extends "layout.html.twig" %}
{% set page_title = "Users" %}
{% block main %}
    {% include "blocks/admin/users/menu.html.twig" %}
    <div class="page-header">
        <h3>Manage Users</h3>
    </div>
    <div class="row">
        <div class="col-md-12">
            {% if pagination %}
                <div class="text-center">
                    {{ pagination|raw }}
                </div>
            {% endif %}
            <div class="table-responsive">
                <table class="table table-striped table-hover" id="users-table">
                    <thead>
                    <tr>
                        <th class="col-md-3">{{ sortlink('userLastName','Last Name',sort)|raw }}</th>
                        <th class="col-md-3">{{ sortlink('userFirstName','First Name',sort)|raw }}</th>
                        <th class="col-md-1">Rank</th>
                        <th class="col-md-3">{{ sortlink('userBase','Base',sort)|raw }}</th>
                        <th class="col-md-2">{{ sortlink('userLastLogin','Last Login',sort)|raw }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for user in users %}
                        <tr data-uuid="{{ user.uuid }}"
                            class="cursor-pointer{% if user.isDisabled %} text-muted{% endif %}">
                            <td>{{ user.lastName }}</td>
                            <td>{{ user.firstName }}</td>
                            <td>{{ user.rank }}</td>
                            <td{% if bases[user.base] %} title="{{ bases[user.base].name }}"{% endif %}>
                                {% if bases[user.base] %}
                                    {{ bases[user.base].name|length > 40 ? bases[user.base].name|slice(0,40) ~ '...' : bases[user.base].name }}
                                {% else %}
                                    &mdash;
                                {% endif %}
                            </td>
                            <td>
                                {% if user.lastLogin %}{{ user.lastLogin|date('d-M-Y') }}{% else %}&mdash;{% endif %}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {% set tableSelector = "#users-table" %}
                {% set redirectPath = "/admin/users" %}
                {% include "utilities/table-row-link.html.twig" %}
            </div>
            {% if pagination %}
                <div class="text-center">
                    {{ pagination|raw }}
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}