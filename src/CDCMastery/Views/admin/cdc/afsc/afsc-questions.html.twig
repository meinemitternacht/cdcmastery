{% extends "layout.html.twig" %}
{% set page_title = "Manage AFSC Questions - #{afsc.name}" %}
{% set num_questions = question_data|length %}
{% block main %}
    {% include "blocks/admin/cdc/afsc/menu.html.twig" %}
    <div class="page-header">
        <h3>Manage AFSC Questions - {{ afsc.name }}</h3>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-3 text-center">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h5>Questions</h5>
                        </div>
                        <div class="panel-body">
                            <strong>{{ num_questions|number_format }}</strong>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 text-center">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h5>FOUO</h5>
                        </div>
                        <div class="panel-body">
                            <strong>{{ afsc.fouo ? 'Yes' : 'No' }}</strong>
                        </div>
                    </div>
                </div>
                {% if afsc.version %}
                    <div class="col-md-6 text-center">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h5>Version</h5>
                            </div>
                            <div class="panel-body">
                                <strong>{{ afsc.version }}</strong>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-9">
            <div class="help-block">
                {% if num_questions > 0 %}
                    Click on a table row to manage question and answer data.
                {% else %}
                    There are no questions in the database for this AFSC.
                {% endif %}
            </div>
        </div>
        <div class="col-md-3 text-right">
            <a class="btn btn-sm btn-success"
               href="/admin/cdc/afsc/{{ afsc.uuid }}/questions/add">
                <span class="glyphicon glyphicon-plus"></span> Add Question
            </a>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            {% if num_questions > 0 %}
                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="questions-table">
                        <tbody>
                        {% set i = 1 %}
                        {% for qa_data in question_data %}
                            <tr data-uuid="{{ qa_data.question.uuid }}"
                                class="cursor-pointer">
                                <td class="text-muted">{{ i }}</td>
                                <td{% if qa_data.question.disabled %} class="bg-danger" title="This question is disabled"{% endif %}>
                                    {% if qa_data.question.disabled %}
                                        <span class="glyphicon glyphicon-remove text-danger"></span>
                                    {% endif %}
                                    {{ qa_data.question.text|length > 140 ? qa_data.question.text|slice(0, 140) ~ '...' : qa_data.question.text }}
                                </td>
                            </tr>
                            {% set i = i + 1 %}
                        {% endfor %}
                        </tbody>
                    </table>
                    {% set tableSelector = "#questions-table" %}
                    {% set redirectPath = "/admin/cdc/afsc/" ~ afsc.uuid ~ "/questions" %}
                    {% include "utilities/table-row-link.html.twig" %}
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}